
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>à¸£à¸°à¸šà¸šà¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢ - EMS UBON</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    body {
      font-family: 'Prompt', sans-serif;
      background: linear-gradient(to bottom, #e53935, #1e88e5);
      color: white;
      padding: 20px;
    }
    h1 {
      font-size: 2.5em;
      text-align: center;
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin-top: 10px;
      font-size: 1.2em;
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 5px;
      font-size: 1em;
      border: none;
      border-radius: 10px;
    }
    .section {
      background-color: rgba(255, 255, 255, 0.2);
      padding: 20px;
      margin-bottom: 30px;
      border-radius: 20px;
    }
    button {
      font-size: 1.2em;
      padding: 10px 30px;
      border: none;
      background: #ffffff;
      color: #e53935;
      border-radius: 10px;
      margin-top: 20px;
      cursor: pointer;
    }
    table {
      width: 100%;
      margin-top: 20px;
      background: white;
      color: black;
      border-collapse: collapse;
    }
    th, td {
      padding: 10px;
      border: 1px solid gray;
    }
  </style>
</head>
<body>

<h1>ğŸ©º à¸£à¸°à¸šà¸šà¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢ <br>EMERGENCY MEDICAL SERVICE UBONRATCHATHANI</h1>

<div class="section">
  <label>ğŸ“… à¸§à¸±à¸™à¸—à¸µà¹ˆ <input type="date" id="date"></label>
  <label>â° à¹€à¸§à¸¥à¸² <input type="time" id="time"></label>
  <label>ğŸš‘ à¸«à¸™à¹ˆà¸§à¸¢à¸›à¸à¸´à¸šà¸±à¸•à¸´à¸à¸²à¸£ <input type="text" id="unit"></label>
  <label>ğŸ§â€â™‚ï¸ à¸Šà¸·à¹ˆà¸­à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢ <input type="text" id="name"></label>
  <label>â¤ï¸ à¹‚à¸£à¸„à¸›à¸£à¸°à¸ˆà¸³à¸•à¸±à¸§ <input type="text" id="disease"></label>
  <label>ğŸ˜· à¸­à¸²à¸à¸²à¸£ <textarea id="symptom"></textarea></label>
  <label>ğŸŒ¡ï¸ T <input id="T" type="text"></label>
  <label>ğŸ’“ P <input id="P" type="text"></label>
  <label>ğŸ’“ PR <input id="PR" type="text"></label>
  <label>ğŸ©º BP <input id="BP" type="text"></label>
  <label>ğŸ« SpO2 <input id="SpO2" type="text"></label>
  <label>ğŸ©¸ DTX <input id="DTX" type="text"></label>
  <label>ğŸ§  E <input id="E" type="text"></label>
  <label>ğŸ—£ï¸ V <input id="V" type="text"></label>
  <label>ğŸ¤² M <input id="M" type="text"></label>
  <label>ğŸ©¹ à¸à¸²à¸£à¸”à¸¹à¹à¸¥ <textarea id="care"></textarea></label>
  <label>ğŸ“ à¸›à¸£à¸°à¸ªà¸²à¸™à¸‡à¸²à¸™ <textarea id="coordination"></textarea></label>
  <label>ğŸ›» à¸£à¸±à¸šà¸ˆà¸²à¸ <input id="from" type="text"></label>
  <label>ğŸ¥ à¸™à¸³à¸ªà¹ˆà¸‡ <input id="to" type="text"></label>

  <button onclick="submitForm()">ğŸ’¾ à¸šà¸±à¸™à¸—à¸¶à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥</button>
  <button onclick="loadData()">ğŸ“‚ à¹€à¸£à¸µà¸¢à¸à¸”à¸¹à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸²à¸ Google Sheet</button>
</div>

<div class="section">
  <h2>ğŸ“‹ à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸¥à¹ˆà¸²à¸ªà¸¸à¸”</h2>
  <table id="latestData">
    <thead>
      <tr><th>à¹€à¸§à¸¥à¸²</th><th>à¸Šà¸·à¹ˆà¸­</th><th>à¸«à¸™à¹ˆà¸§à¸¢</th><th>à¸­à¸²à¸à¸²à¸£</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbwN_M1DxJQAyDasTjvgANSlV1bXh1hGN457YThbzpy3J6X1PDjAxbEXP2wNS6crTp6j5Q/exec';

  function submitForm() {
    const formData = {
      date: document.getElementById("date").value,
      time: document.getElementById("time").value,
      unit: document.getElementById("unit").value,
      name: document.getElementById("name").value,
      disease: document.getElementById("disease").value,
      symptom: document.getElementById("symptom").value,
      T: document.getElementById("T").value,
      P: document.getElementById("P").value,
      PR: document.getElementById("PR").value,
      BP: document.getElementById("BP").value,
      SpO2: document.getElementById("SpO2").value,
      DTX: document.getElementById("DTX").value,
      E: document.getElementById("E").value,
      V: document.getElementById("V").value,
      M: document.getElementById("M").value,
      care: document.getElementById("care").value,
      coordination: document.getElementById("coordination").value,
      from: document.getElementById("from").value,
      to: document.getElementById("to").value,
    };

    Swal.fire({ title: 'à¸à¸³à¸¥à¸±à¸‡à¸šà¸±à¸™à¸—à¸¶à¸...', allowOutsideClick: false, didOpen: () => Swal.showLoading() });

    fetch(scriptURL, { method: 'POST', body: new URLSearchParams(formData) })
      .then(response => {
        Swal.fire('à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¸³à¹€à¸£à¹‡à¸ˆ!', '', 'success');
        localStorage.setItem("lastFormData", JSON.stringify(formData));
      })
      .catch(error => {
        Swal.fire('à¹€à¸à¸´à¸”à¸‚à¹‰à¸­à¸œà¸´à¸”à¸à¸¥à¸²à¸”', error.message, 'error');
      });
  }

  function loadData() {
    window.open("https://docs.google.com/spreadsheets/d/xxxxxxxxxxxxxxxxxxxx/edit", "_blank");
  }

  window.onload = () => {
    const last = JSON.parse(localStorage.getItem("lastFormData"));
    if (last) {
      for (let key in last) {
        if (document.getElementById(key)) {
          document.getElementById(key).value = last[key];
        }
      }
    }
  };
</script>

</body>
</html>
